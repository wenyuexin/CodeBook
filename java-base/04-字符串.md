# 字符串

字符串不是Java内置的数据类型，而是java.lang下的一个类。

## 不可修改

String 类没有提供用于修改字符串的方法，因此String 类对象称为不可变字 符串。可以通过拼接来创建一个新字符串，这样效率不高，但译器可以让字符串共享。其原因在于，Java 的设计者认为共享带来的高效率远远胜过于提取、 拼接字符串所带来的低效率。

## 是否相等

使用 equals 方法检测两个字符串是否相等，不要使用==运算符。如果虚拟机始终将相同的字符串共享， 就可以使用==运算符检测是否相等。但实际上  只有字符串常量是共享的，而 + 或 substring 等操作产生的结果并不是共享的。

## 码点与代码单元

Java 字符串由 char 值序列组成， char 数据类型是一 个采用 UTF-16 编码表示 Unicode 码点的代码单元。大多数的常用 Unicode 字符使用一个代 码单元就可以表示，而辅助字符需要一对代码单元表示。

length 方法将返回采用 UTF-16 编码表示的给定字符串所需要的代码单元数量。要想得到实际的长度，即码点数量，可以调用

```java
public int codePointCount(int beginIndex, int endIndex)
```

**Java9的改进**：

Java9改进了字符串（包括String、StringBuffer、StringBuilder）的实现。在Java9以前，默认使用UTF-16编码，采用**char[]数组**保存，因此每个字符固定占2字节；而Java9以后，采用**byte[]数组**保存，同事String类内部增加了coder字段用以记录编码格式是LATIN1还是UTF-16。因此多数情况下，新版本单个字符只占1字节，更加节省空间。

## 构建字符串

通常少量较短的字符串可以直接使用+运算符，多次拼接可以使用StringBuilder类，该对象支持通过append方法追加字串。

StringBuffer类和StringBuilder类似，区别在StringBuffer的方法添加了synchronized关键字，是线程安全的，性能上弱于StringBuilder。

当然，实际编程中idea会提示推荐直接使用+运算符拼接，不需要使用StringBuffer、StringBuilder 或 StringJoiner，因为编译器会自动优化成StringBuilder，效率上没有明显差异，直接使用+运算符编码看起来更直观。

## 控制台输入输出

日常编程更多使用日志类输出字符串，用以提供关键信息，但偶尔也可以直接打印到控制台，只需要使用System.out类的println方法即可，而从控制台读取输入则需要借助java.util.Scanner类

```java
Scanner in = new Scanner(System.in);
String str = in.nextLine();
String word = in.next(); // 以空格作为分割符号, 读取一个单词
int num = in.nextInt();
```

## 格式化输出

String的format(String format, Object... args) 可以按指定格式输出新的字符串。使用System.out.println打印时类似。

| 转  换  符 | 说    明                 | 示    例  |
| ------- | ---------------------- | ------- |
| %s      | 字符串类型                  | "abc"   |
| %c      | 字符类型                   | 'm'     |
| %b      | 布尔类型                   | true    |
| %d      | 整数类型（十进制）              | 99      |
| %x      | 整数类型（十六进制）             | FF      |
| %o      | 整数类型（八进制）              | 77      |
| %f      | 浮点类型                   | 99.99   |
| %a      | 十六进制浮点类型               | FF.35AE |
| %e      | 指数类型                   | 9.38e+5 |
| %g      | 通用浮点类型（f和e类型中较短的）      |         |
| %h      | 散列码                    |         |
| %%      | 百分比类型                  | ％       |
| %n      | 换行符                    |         |
| %tx     | 日期与时间类型（x代表不同的日期与时间转换符 |         |

对于Date类，可以使用以下符号输出更细致的格式

| 转  换  符 | 说    明                | 示    例                      |
| ------- | --------------------- | --------------------------- |
| c       | 包括全部日期和时间信息           | 星期六 十月 27 14:21:20 CST 2007 |
| F       | “年-月-日”格式             | 2007-10-27                  |
| D       | “月/日/年”格式             | 10/27/07                    |
| r       | “HH:MM:SS PM”格式（12时制） | 02:25:51 下午                 |
| T       | “HH:MM:SS”格式（24时制）    | 14:28:16                    |
| R       | “HH:MM”格式（24时制）       | 14:28                       |
| I       | 2位数字12时制的小时（不足2位前面补0） | 03                          |
| k       | 2位数字24时制的小时（前面不补0）    | 15                          |
| l       | 2位数字12时制的小时（前面不补0）    | 3                           |
| M       | 2位数字的分钟（不足2位前面补0）     | 03                          |
| S       | 2位数字的秒（不足2位前面补0）      | 09                          |
| L       | 3位数字的毫秒（不足3位前面补0）     | 015                         |
| N       | 9位数字的毫秒数（不足9位前面补0）    | 562000000                   |
| p       | 小写字母的上午或下午标记          | 中：下午英：pm                    |
| z       | 相对于GMT的RFC822时区的偏移量   | +0800                       |
| Z       | 时区缩写字符串               | CST                         |

参考

https://www.cnblogs.com/HOI-Yzy/p/14671806.html
