# 2-3查找树

2-3查找树（以下简称23树）是对二叉查找树的延伸。

二叉查找树的算法运行时间取决于树的形状，而树的形状取决于插入键的值以及键的插入顺序。在最好的情况下，一颗含有N个节点的树是**完全平衡**的，那么每条空链接和根节点的距离都为`~lgN`。在最坏的情况下，搜索路径上可能有N个节点。

**命题：在由N个随机键构造的二叉查找树中插入和查找未命中平均所需的比较次数为`~lnN`（约为`1.39lgN`）。**

**命题：在一颗二叉查找树中，所有操作在最坏情况下所需的时间都和树的高度成正比。**

对于一颗完美平衡的23树，其所有空链接到根节点的距离都是相同的。当然，由于节点个数不一定能刚好构建一颗完美的平衡的树，实际中通常是：

**平衡树**：是一棵空树或它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵平衡二叉树。

**树的动态平衡**： 在对树进行插入操作时，每个动态的状态都能满足静态的平衡条件。

<br>

### 2-3查找树的定义：

> 一棵2-3查找树或为一颗空树，或由以下节点组成：
>
> * 2-节点：含有一个键和两条链接，左链接指向的2-3树中的键都小于该节点，右链接指向的2-3树> 中的键都大于该节点。
>
> * 3-节点：含有两个键和三条链接，左链接指向的2-3树中的键都小于该节点，中链接指向的2-3树> 中的键都位于该节点的两个键之间，右链接指向的2-3树中的键都大于该节点。

![img](https://img-blog.csdn.net/20170328154632457?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxNDY4ODE0NQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

  ### 查找

23树中的查找和二叉树类似，主要区别是在于3节点。当遇到3节点时，需要根据节点中两个键的值（假设为V1和V2，V1<V2）做进一步判断：若小于V1则在左子树中继续查找，若大于V2则在右子树中查找，否则在中子树继续查找。以此类推，直到命中或者遇到空链接。

### 插入

23树的插入更为复杂。向23树中插入新键可以先做一次未命中的查找。根据查找停止时空链接对应的节点，可以分为向2节点中插入和3节点中插入两种情况。

**1）向2节点中插入新键**

此时仅需将2节点替换为3节点，然后将要插入的键保存在其中即可。

**2）向一个父节点为2节点的3节点中插入键**

先将3节点变为一个临时的4节点，将键放入其中；

再将4节点的中键向上移动到父节点中，并将其变为3节点

**3）向一个父节点为3节点的3节点中插入键**

先将3节点变为一个临时的4节点，将键放入其中；

再将4节点的中键向上移动到父节点中，以此类推，直到遇到2节点或根节点：

如果遇到2节点，则只需将2节点变为一个不需要继续分解的3节点，

如果遇到根节点，可以先将根节点变为4节点，然后将中间键上移，变为新的根节点



<br>

---

**参考资料**

1. 《算法（第4版）》 Robert Sedgewick, Kevin Wayne，人民邮电出版社，第3章
2.  [算法原理系列：2-3查找树](https://blog.csdn.net/u014688145/article/details/67636509)
